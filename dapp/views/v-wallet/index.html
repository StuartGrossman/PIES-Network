<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>PIES Network</title>
  <link rel="stylesheet" type="text/css" href="../sources/css/bootstrap.min.css">
  <!-- Bootstrap Core CSS -->
    <link href="../sources/css/bootstrap-extension.css" rel="stylesheet">
    <!-- Menu CSS -->
    <link href="../sources/css/sidebar-nav.min.css" rel="stylesheet">
    <!-- toast CSS -->
    <link href="../sources/css/jquery.toast.css" rel="stylesheet">
    <!-- morris CSS -->
    <link href="../sources/css/morris.css" rel="stylesheet">
    <!-- animation CSS -->
    <link href="../sources/css/animate.css" rel="stylesheet">
    <!-- Custom CSS -->
    <!-- <link href="../sources/css/admin-style.css" rel="stylesheet"> -->
    <!-- color CSS -->
    <link href="../sources/css/viewer.css" id="theme" rel="stylesheet">

    <link href="../sources/css/default.css" id="theme" rel="stylesheet">
    <link href="../sources/css/spinners.css" />
    <link href="../sources/css/custom.css" rel="stylesheet" />
</head>




<body>

    <div id="wrapper" class="main-container" id="main-container">
        <!-- Navigation -->

        <nav class="navbar navbar-default navbar-static-top m-b-0">
            <div class="navbar-header"> <a class="navbar-toggle hidden-sm hidden-md hidden-lg " href="javascript:void(0)" data-toggle="collapse" data-target=".navbar-collapse"><i class="ti-menu"></i></a>
                <ul class="nav navbar-top-links navbar-left hidden-xs">
                    <li><a href="javascript:void(0)" class="open-close hidden-xs waves-effect waves-light"><i class="icon-arrow-left-circle ti-menu"></i></a></li>
                    <li>
                        <!-- <form role="search" class="app-search hidden-xs"> -->
                            <!-- <input type="text" placeholder="Search..." class="form-control"> <a href=""><i class="fa fa-search"></i></a> </form> -->
                            <!-- <li><a href="gallery.html" class="waves-effect"><i class="fa fa-circle-o text-info"></i> <span class="hide-menu" id="balance"></span></a></li> -->

                    </li>
                </ul>
                <ul class="nav navbar-top-links navbar-right pull-right">
                    <li class="dropdown"> <a class="dropdown-toggle waves-effect waves-light" data-toggle="dropdown" href="/a-ads"><i class="icon-envelope"></i>
                                              <div class="notify"><span class="heartbit">
                                                </span><span class="point"></span>
                                              </div>
                                          </a>
                        <ul class="dropdown-menu mailbox animated bounceInDown">
                            <li>
                                <div class="drop-title">You have 4 new messages</div>
                            </li>
                            <li>
                                <div class="message-center">
                                    <a href="#">
                                        <div class="user-img"> <img src="../sources/images/pawandeep.jpg" alt="user" class="img-circle"> <span class="profile-status online pull-right"></span> </div>
                                        <div class="mail-contnet">
                                            <h5>Pavan kumar</h5> <span class="mail-desc">Just see the my admin!</span> <span class="time">9:30 AM</span> </div>
                                    </a>
                                    <a href="#">
                                        <div class="user-img"> <img src="../sources/images/sonu.jpg" alt="user" class="img-circle"> <span class="profile-status busy pull-right"></span> </div>
                                        <div class="mail-contnet">
                                            <h5>Sonu Nigam</h5> <span class="mail-desc">I've sung a song! See you at</span> <span class="time">9:10 AM</span> </div>
                                    </a>
                                    <a href="#">
                                        <div class="user-img"> <img src="../sources/images/arijit.jpg" alt="user" class="img-circle"> <span class="profile-status away pull-right"></span> </div>
                                        <div class="mail-contnet">
                                            <h5>Arijit Sinh</h5> <span class="mail-desc">I am a singer!</span> <span class="time">9:08 AM</span> </div>
                                    </a>
                                    <a href="#">
                                        <div class="user-img"> <img src="../sources/images/pawandeep.jpg" alt="user" class="img-circle"> <span class="profile-status offline pull-right"></span> </div>
                                        <div class="mail-contnet">
                                            <h5>Pavan kumar</h5> <span class="mail-desc">Just see the my admin!</span> <span class="time">9:02 AM</span> </div>
                                    </a>
                                </div>
                            </li>
                            <li>
                                <a class="text-center" href="javascript:void(0);"> <strong>See all notifications</strong> <i class="fa fa-angle-right"></i> </a>
                            </li>
                        </ul>
                        <!-- /.dropdown-messages -->
                    </li>
                    <!-- /.dropdown -->
                    <li class="dropdown"> <a class="dropdown-toggle waves-effect waves-light" data-toggle="dropdown" href="/a-upload"><i class="icon-note"></i>
                    <div class="notify"><span class="heartbit"></span><span class="point"></span></div>
                    </a>
                        <ul class="dropdown-menu dropdown-tasks animated slideInUp">
                            <li>
                                <a href="#">
                                    <div>
                                        <p> <strong>Task 1</strong> <span class="pull-right text-muted">40% Complete</span> </p>
                                        <div class="progress progress-striped active">
                                            <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 40%"> <span class="sr-only">40% Complete (success)</span> </div>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li class="divider"></li>
                            <li>
                                <a href="#">
                                    <div>
                                        <p> <strong>Task 2</strong> <span class="pull-right text-muted">20% Complete</span> </p>
                                        <div class="progress progress-striped active">
                                            <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 20%"> <span class="sr-only">20% Complete</span> </div>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li class="divider"></li>
                            <li>
                                <a href="#">
                                    <div>
                                        <p> <strong>Task 3</strong> <span class="pull-right text-muted">60% Complete</span> </p>
                                        <div class="progress progress-striped active">
                                            <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%"> <span class="sr-only">60% Complete (warning)</span> </div>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li class="divider"></li>
                            <li>
                                <a href="#">
                                    <div>
                                        <p> <strong>Task 4</strong> <span class="pull-right text-muted">80% Complete</span> </p>
                                        <div class="progress progress-striped active">
                                            <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 80%"> <span class="sr-only">80% Complete (danger)</span> </div>
                                        </div>
                                    </div>
                                </a>
                            </li>
                            <li class="divider"></li>
                            <li>
                                <a class="text-center" href="#"> <strong>See All Tasks</strong> <i class="fa fa-angle-right"></i> </a>
                            </li>
                        </ul>
                        <!-- /.dropdown-tasks -->
                    </li>
                    <!-- /.dropdown -->
                    <!-- .Megamenu -->
                    <!-- <li class="mega-dropdown"> <a class="dropdown-toggle waves-effect waves-light" data-toggle="dropdown" href="#"><span class="hidden-xs">Mega</span> <i class="icon-options-vertical"></i></a>
                        <ul class="dropdown-menu mega-dropdown-menu animated bounceInDown">
                            <li class="col-sm-3">
                                <ul>
                                    <li class="dropdown-header">Forms Elements</li>
                                    <li><a href="form-basic.html">Basic Forms</a></li>
                                    <li><a href="form-layout.html">Form Layout</a></li>
                                    <li><a href="form-advanced.html">Form Addons</a></li>
                                    <li><a href="form-material-elements.html">Form Material</a></li>
                                    <li><a href="form-float-input.html">Form Float Input</a></li>
                                    <li><a href="form-upload.html">File Upload</a></li>
                                    <li><a href="form-mask.html">Form Mask</a></li>
                                    <li><a href="form-img-cropper.html">Image Cropping</a></li>
                                    <li><a href="form-validation.html">Form Validation</a></li>
                                </ul>
                            </li>
                            <li class="col-sm-3">
                                <ul>
                                    <li class="dropdown-header">Advance Forms</li>
                                    <li><a href="form-dropzone.html">File Dropzone</a></li>
                                    <li><a href="form-pickers.html">Form-pickers</a></li>
                                    <li><a href="icheck-control.html">Icheck Form Controls</a></li>
                                    <li><a href="form-wizard.html">Form-wizards</a></li>
                                    <li><a href="form-typehead.html">Typehead</a></li>
                                    <li><a href="form-xeditable.html">X-editable</a></li>
                                    <li><a href="form-summernote.html">Summernote</a></li>
                                    <li><a href="form-bootstrap-wysihtml5.html">Bootstrap wysihtml5</a></li>
                                    <li><a href="form-tinymce-wysihtml5.html">Tinymce wysihtml5</a></li>
                                </ul>
                            </li>
                            <li class="col-sm-3">
                                <ul>
                                    <li class="dropdown-header">Table Example</li>
                                    <li><a href="basic-table.html">Basic Tables</a></li>
                                    <li><a href="table-layouts.html">Table Layouts</a></li>
                                    <li><a href="data-table.html">Data Table</a></li>
                                    <li class="hidden"><a href="crud-table.html">Crud Table</a></li>
                                    <li><a href="bootstrap-tables.html">Bootstrap Tables</a></li>
                                    <li><a href="responsive-tables.html">Responsive Tables</a></li>
                                    <li><a href="editable-tables.html">Editable Tables</a></li>
                                    <li><a href="foo-tables.html">FooTables</a></li>
                                    <li><a href="jsgrid.html">JsGrid Tables</a></li>
                                </ul>
                            </li>
                            <li class="col-sm-3">
                                <ul>
                                    <li class="dropdown-header">Charts</li>
                                    <li> <a href="flot.html">Flot Charts</a> </li>
                                    <li><a href="morris-chart.html">Morris Chart</a></li>
                                    <li><a href="chart-js.html">Chart-js</a></li>
                                    <li><a href="peity-chart.html">Peity Charts</a></li>
                                    <li><a href="knob-chart.html">Knob Charts</a></li>
                                    <li><a href="sparkline-chart.html">Sparkline charts</a></li>
                                    <li><a href="extra-charts.html">Extra Charts</a></li>
                                </ul>
                            </li>
                            <li class="col-sm-12 m-t-40 demo-box">
                                <div class="row">
                                    <div class="col-sm-2">
                                        <div class="white-box text-center bg-purple"><a href="../eliteadmin-inverse/index.html" target="_blank" class="text-white"><i class="linea-icon linea-basic fa-fw" data-icon="v"></i><br/>Demo 1</a></div>
                                    </div>
                                    <div class="col-sm-2">
                                        <div class="white-box text-center bg-success"><a href="../eliteadmin/index.html" target="_blank" class="text-white"><i class="linea-icon linea-basic fa-fw" data-icon="v"></i><br/>Demo 2</a></div>
                                    </div>
                                    <div class="col-sm-2">
                                        <div class="white-box text-center bg-info"><a href="../eliteadmin-ecommerce/index.html" target="_blank" class="text-white"><i class="linea-icon linea-basic fa-fw" data-icon="v"></i><br/>Demo 3</a></div>
                                    </div>
                                    <div class="col-sm-2">
                                        <div class="white-box text-center bg-inverse"><a href="../eliteadmin-horizontal-navbar/index3.html" target="_blank" class="text-white"><i class="linea-icon linea-basic fa-fw" data-icon="v"></i><br/>Demo 4</a></div>
                                    </div>
                                    <div class="col-sm-2">
                                        <div class="white-box text-center bg-warning"><a href="../eliteadmin-iconbar/index4.html" target="_blank" class="text-white"><i class="linea-icon linea-basic fa-fw" data-icon="v"></i><br/>Demo 5</a></div>
                                    </div>
                                    <div class="col-sm-2">
                                        <div class="white-box text-center bg-danger"><a href="https://themeforest.net/item/elite-admin-responsive-web-app-kit-/16750820" target="_blank" class="text-white"><i class="linea-icon linea-ecommerce fa-fw" data-icon="d"></i><br/>Buy Now</a></div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </li> -->
                    <!-- /.Megamenu -->
                    <!-- <li class="right-side-toggle"> <a class="waves-effect waves-light" href="javascript:void(0)"><i class="ti-settings"></i></a></li> -->
                    <!-- /.dropdown -->
                </ul>
            </div>
        </nav>
        <!-- Left navbar-header -->
        <div class="navbar-default sidebar" role="navigation">
            <div class="sidebar-nav navbar-collapse slimscrollsidebar">
                <div class="user-profile">
                    <div class="dropdown user-pro-body">

                      <div>
                        <img id="userImage" alt="user-img" class="img-circle"></div> <a href="#" class="dropdown-toggle u-dropdown" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" id="userName"><span class="caret"></span></a>
                        <ul class="dropdown-menu animated flipInY">
                            <li><a href="#"><i class="ti-user"></i> My Profile</a></li>
                            <li><a href="#"><i class="ti-wallet"></i> My Balance</a></li>
                            <li><a href="#"><i class="ti-email"></i> Inbox</a></li>
                            <li role="separator" class="divider"></li>
                            <li><a href="#"><i class="ti-settings"></i> Account Setting</a></li>
                            <li role="separator" class="divider"></li>
                            <li><a href="login.html"><i class="fa fa-power-off"></i> Logout</a></li>
                        </ul>
                    </div>
                </div>
                <ul class="nav" id="side-menu">
                    <li class="sidebar-search hidden-sm hidden-md hidden-lg">
                        <!-- input-group -->
                        <div class="input-group custom-search-form">
                            <input type="text" class="form-control" placeholder="Search..."> <span class="input-group-btn">
            <button class="btn btn-default" type="button"> <i class="fa fa-search"></i> </button>
            </span> </div>
                        <!-- /input-group -->
                    </li>
                    <!-- <li class="nav-small-cap m-t-10"> Main Menu</li> -->
                    <li> <a href="index.html" class="waves-effect active"><i class="linea-icon linea-basic fa-fw" data-icon="v"></i> <span class="hide-menu"> Dashboard <span class="fa arrow"></span> <span class="label label-rouded label-custom pull-right" id="alerts">4</span></span></a>
                        <ul class="nav nav-second-level">
                            <!-- <li> <a href="index.html">Minimalistic</a> </li>
                            <!-- <li> <a href="index2.html">Demographical</a> </li> -->
                            <!-- <li> <a href="/a-upload"></a> </li> -->
                            <li> <a href="/content">My Content</a> </li>
                        </ul>
                    </li>
                    <!-- <li><a href="/v-wallet" class="waves-effect"><i class="icon-wallet fa-fw"></i> <span class="hide-menu">Wallet</span></a></li> -->


                    <li> <a href="/v-settings" class="waves-effect"><i data-icon="P" class="linea-icon linea-basic fa-fw"></i> <span class="hide-menu">Settings</span></a> </li>
                    <!-- <li> <a href="#" class="waves-effect"><i data-icon="7" class="linea-icon linea-basic fa-fw"></i> <span class="hide-menu">Icons<span class="fa arrow"></span></span></a> -->
                        <ul class="nav nav-second-level">
                            <!-- <li> <a href="fontawesome.html">Font awesome</a> </li>
                            <li> <a href="themifyicon.html">Themify Icons</a> </li>
                            <li> <a href="simple-line.html">Simple line Icons</a> </li>
                            <li><a href="linea-icon.html">Linea Icons</a></li>
                            <li><a href="weather.html">Weather Icons</a></li> -->
                        </ul>
                    </li>

                    <li><a href="login.html" class="waves-effect"><i class="icon-logout fa-fw"></i> <span class="hide-menu">Logout</span></a></li>
                    <!-- <li class="nav-small-cap"> Support</li> -->
                    <!-- <li><a href="documentation.html" class="waves-effect"><i class="fa fa-circle-o text-danger"></i> <span class="hide-menu">Documentation</span></a></li> -->
                    <!-- <li><a href="faq.html" class="waves-effect"><i class="fa fa-circle-o text-success"></i> <span class="hide-menu">Faqs</span></a></li> -->
                </ul>
            </div>
        </div>
        <!-- Left navbar-header end -->

        <!-- Page Content -->
        <div id="page-wrapper">
            <div class="container-fluid">
                <div class="row bg-title">
                    <div class="col-lg-3 col-md-4 col-sm-4 col-xs-12">
                        <!-- <h4 class="page-title">Settings</h4> </div> -->
                   <!-- <div class="col-lg-9 col-sm-8 col-md-8 col-xs-12"> <a href="https://themeforest.net/item/elite-admin-responsive-dashboard-web-app-kit-/16750820" target="_blank" class="btn btn-danger pull-right m-l-20 btn-rounded btn-outline hidden-xs hidden-sm waves-effect waves-light">Buy Now</a> -->
                        <ol class="breadcrumb">
                          <li><a href="/v-dashboard">Dashboard</a></li>
                          <li class="active">My Wallet</li>
                        </ol>
                    </div>

                </div>



                <div class="col-md-6">
                  <div class="m-b-15" style="background-color: #4f5467">
                    <div id="inBalanceMatrix">
                      <div class="row weather p-20">
                          <div class="col-md-12 col-xs-12 col-lg-12 col-sm-12">
                              <h3>&nbsp;</h3>
                              <h1>My Internal PIES Balance</h1>
                              <h5 style="color:white;">Tokens avaliable for withdrawl from the network</h5>
                          </div>

                      </div>
                      <div class="row weather p-20">
                        <div class="col-md-8 col-xs-10 col-lg-6 col-sm-10">
                          <span style="color:white; font-size:40px;" id="internalBalance"></span><span style="color:orange; font-size: 30px;" > PIES Tokens</span>

                        </div>
                        <div class="col-md-4 col-xs-2 col-lg-6 col-sm-2">
                          <button class="btn btn-primary" id="addContent" data-toggle="modal" data-target="#exampleModal" data-whatever="@mdo">Withdraw</button>

                        </div>
                      </div>

                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="m-b-15" style="background-color: #4f5467">
                    <div id="outBalanceMatrix">
                      <div class="row weather p-20">
                          <div class="col-md-12 col-xs-12 col-lg-12 col-sm-12">
                              <h3>&nbsp;</h3>
                              <h1>ETH Address PIES Balance</h1>
                              <h5 style="color:white;">Tokens connected to my personal ETH address</h5>
                          </div>

                      </div>
                      <div class="row weather p-20">
                        <div class="col-md-12 col-xs-10 col-lg-12 col-sm-10">
                          <span style="color:white; font-size:40px;" id="balance"></span><span style="color:orange; font-size: 30px;" > PIES Tokens</span>
                        </div>
                        <div class="col-md-4 col-xs-2 col-lg-6 col-sm-2">

                        </div>
                      </div>

                    </div>
                  </div>
                </div>


                <div class="col-md-12">
                  <div class=" m-b-15" style="background-color: #4f5467">
                    <div id="ethMatrix">
                      <div class="row weather p-20">
                          <div class="col-md-12 col-xs-12 col-lg-12 col-sm-12">
                              <h3>&nbsp;</h3>
                              <h1>My Ethereum Address </h1>
                          </div>

                      </div>
                      <div class="row weather p-20">
                        <div class="col-md-8 col-xs-10 col-lg-6 col-sm-10">
                          <span style="font-size: 18px; color:orange;" id="myAddress">No Ethereum address selected</span>

                        </div>
                        <div class="col-md-4 col-xs-2 col-lg-6 col-sm-2">
                          <button class="btn btn btn-primary" onclick="editEthAddress()" id="edit">edit</button>

                        </div>
                      </div>
                      <div class="row weather p-20" id="editEth">
                        <div class="row">
                          <div class="col-md-8 col-xs-6 col-lg-8 col-sm-6">
                          <p class="text-white">
                             Please double check address before submission
                          </p>
                        </div>
                      </div>
                        <div class="col-md-8 col-xs-6 col-lg-8 col-sm-6" id="ethHolder">
                          <!-- <p class="text-white">
                             Please double check address before submission
                          </p> -->
                          <input class="form-control" placeholder="My Ethereum Address" id="myEthAddress"/>
                          <!-- <button onclick="submitEthAddress()" class="btn btn-warning">Submit</button> -->
                        </div>
                        <div class="col-md-4 col-xs-6 col-lg-4 col-sm-6" id="ethbutton">
                          <br />
                          <button class="btn btn-primary" onclick="submitEthAddress()">Submit</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel1">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title" id="exampleModalLabel1">Withdrawl - Balance: <span id="modalBalance"></span> </h4> </div>
                            <div class="modal-body">
                                <form>
                                    <div class="form-group">
                                        <label for="recipient-name" class="control-label">Ammount</label>
                                        <input type="number" class="form-control" id="ethAmmountWithdrawl" maxlength="40" id="name">
                                        <h6 style="color: red; display: none;" id="ammountError">Required or too large</h6>

                                    </div>
                                    <div class="form-group">
                                        <label for="recipient-name" class="control-label">ETH Withdrawl Address</label>
                                        <input type="text" class="form-control" id="ethWithdrawlAddress"  maxlength="42" >
                                        <h6 style="color: red; display: none;" id="ethError">Required</h6>

                                    </div>

                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary" id="step2">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal fade" id="exampleModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModal2Label1">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title" id="exampleModal2Label1">Confirm Withdrawl</h4> </div>
                            <div class="modal-body">
                              <h6 style="color: red">Please make sure all information is correct, once tokens are withdrawn we will be unable to issue refunds</h6>
                                 <div class="white-box">

                                   <span style="font-size: 12px;">Ammount:</span>

                                   <span style="font-size: 18px; color:orange;" id="ammountForWithdrawl"></span>
                                   <span style="font-size: 12px; font-weight:normal; color:gray;">PIES Tokens</span>

                                   <br /><hr />
                                   <span style="font-size: 12px;">To:</span>

                                   <span style="font-size: 18px; color:orange;" id="ethAddressForWithdrawl"></span>
                                   <br /> <hr />

                                   <span style="font-size: 12px;">Fee:</span>

                                   <span style="font-size: 18px; color:orange;" id="fee"></span>
                                   <span style="font-size: 12px; font-weight:normal; color:gray;">PIES Tokens</span>

                                   <br /> <hr />

                                   <span style="font-size: 12px;">Total:</span>

                                   <span style="font-size: 18px; color:orange;" id="totalWithdrawlAmmount"></span>
                                   <span style="font-size: 12px; font-weight:normal; color:gray;">PIES Tokens</span>

                                 </div>
                                 <input type="number" placeholder="Confirmation Code" id="confirmationCode" class="form-control"></input>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" id="sendCodeButton" onclick="sendCode()">Send Code</button>
                                <button type="button" class="btn btn-primary" onclick="confirmWithdrawl()" id="step3">Confirm</button>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
        </div>
        <!-- /#page-wrapper -->
    </div>
  </div>



  <div>
    <section id="loaderSection" class="loaderSection" style="background: white">
        <div id="loader" class="loader" >
          <div class="box"></div>
          <div class="hill"></div>
        </div>
    </section>
  </div>
</body>
<script src="https://www.gstatic.com/firebasejs/4.1.3/firebase.js"></script>

<!-- jQuery -->

<script src="https://www.gstatic.com/firebasejs/4.1.3/firebase.js"></script>
<script src="../sources/js/utilites/jquery.min.js"></script>
<script src="../sources/js/utilites/tether.min.js"></script>
<script src="../sources/js/utilites/bootstrap.min.js"></script>
<script src="../sources/js/utilites/sidebar-nav.min.js"></script>
<script src="../sources/js/utilites/jquery.slimscroll.js"></script>
<script src="../sources/js/utilites/waves.js"></script>
<script src="../sources/js/utilites/jquery.waypoints.min.js"></script>
<script src="../sources/js/utilites/jquery.counterup.min.js"></script>
<script src="../sources/js/utilites/raphael-min.js"></script>
<script src="../sources/js/utilites/bootstrap-tagsinput.min.js"></script>
<script src="../sources/js/utilites/custom.min.js"></script>
<script src="../sources/js/utilites/jquery.sparkline.min.js"></script>
<script src="../sources/js/utilites/dashboard1.js"></script>
<script src="../sources/js/utilites/jquery.charts-sparkline.js"></script>
<script src="../sources/js/utilites/jquery.toast.js"></script>
<script src="../sources/js/utilites/jQuery.style.switcher.js"></script>
<script src="../sources/js/utilites/dropify.min.js"></script>
<script src="../sources/js/utilites/bootstrap-select.min.js"></script>
<script src="../sources/js/utilites/switchery.min.js"></script>
<script src="../sources/js/utilites/ethjs-query.min.js"></script>
<script src="../sources/js/utilites/ethjs-contract.min.js"></script>


<script type="text/javascript">
  $(document).ready(function() {
  // console.log("js script online")
  var loadTime = Math.floor((Math.random() * 3000) + 500);
  //////loader
  $('.main-container').css("display", "none");
  // $('#successMessage').hide();
  setTimeout(function(){
    $('.loader').hide();
    $('.loaderSection').hide();



    $('.main-container').css("display", "initial")
  }, loadTime);
    $.toast({
        heading: 'Welcome to Pies',
        text: 'Loading your pecies now!',
        position: 'top-right',
        loaderBg: '#ff6849',
        icon: 'info',
        hideAfter: loadTime,
        stack: 6
    })
  });
  var withdrawlEthAddress;
  var withdrawlAmmount;
  var ammountConfirmed;
  $('#step2').on('click', function(e){
    withdrawlEthAddress = $('#ethWithdrawlAddress').val();
    withdrawlAmmount = $('#ethAmmountWithdrawl').val();
    confirmAmmount(withdrawlAmmount);


    setTimeout(function(){
      if(ammountConfirmed >= Number(withdrawlAmmount)){
        var ammountRequired = true;
      }else{
        var ammountRequired = false;
      }
      console.log(ammountRequired, ammountConfirmed, withdrawlAmmount)

      if(withdrawlEthAddress && withdrawlAmmount && ammountRequired){
          $('#exampleModal').modal('hide');
          calculateFee()
          $('#exampleModal2').modal();
      }else{
        // console.log("working")
        $('#ethError').css('display', 'block');
        $('#ethError').addClass('animate fadeIn');
        $('#ammountError').css('display', 'block');
        $('#ammountError').addClass('animate fadeIn');

      }
    }, 300)

  });
  var loaderShow = function(){
    $('.main-container').css("display", "none")

    $('.loader').show();
    $('.loaderSection').show();

  }
  var loaderHide = function(){
    $('.loader').hide();
    $('.loaderSection').hide();
    $('.main-container').show();

  }
</script>


<script>
var config = {
  apiKey: "AIzaSyBNyW7vjQSK2Gbrh4Mzox6G-uAG4gK1rgE",
  authDomain: "adspace-9fe5c.firebaseapp.com",
  databaseURL: "https://adspace-9fe5c.firebaseio.com",
  projectId: "adspace-9fe5c",
  storageBucket: "",
  messagingSenderId: "129227170241"
};

firebase.initializeApp(config);
var ref = firebase.database().ref('queue/tasks');
var userObject, tagBox;
var totalWithdrawlAmmount, tokenFeeAmmount, withdrawlEthAddress;
var tagAmmount = document.getElementById('tagAmmount');
var tagProgress = document.getElementById('tagProgress');
var statusState = true;
firebase.auth().onAuthStateChanged(function(user) {
  if(user){
    userObject = user;
    // checkState(userObject);
    Onload()
    // asyncWait();
    // console.log(user)
    document.getElementById('userImage').src = user.photoURL;
    document.getElementById('userName').innerHTML = user.displayName;

    // writeUserData(u)

  }else{
    window.location = '/';

  }
})

function checkState(user){
  console.log('checking State', user)
  var userRef = firebase.database().ref('user/' + user.uid);
  userRef.on('value', function(snapshot){
    // console.log(snapshot.val())
    var userStatus = snapshot.val().userType;
    if(userStatus && statusState){
      // console.log(userStatus)
      if(userStatus == 10){
        console.log("Usere Status is Go, hitting Onload Function");
        // userRef.off();

        Onload();
        statusState = false;
        return;
      }else if(userStatus == 99){
        window.location = '/a-dashboard';
        userRef.off();

      }else{
        window.location = '/';
        userRef.off();

      }
    }else if(!statusState && userStatus){
      // window.location = '/';
      // userRef.off();
      return;

    }else {
      window.location = '/';
      userRef.off();
    }
  })
}

function sendCode(){
  var button = document.getElementById('sendCodeButton')
  button.setAttribute('disabled', 'true');
  firebase.database().ref('/queue/withdrawPhoneCheck/tasks').push({'userId': userObject.uid, "message": "PIES Withdraw code is"}).then(function(res, err){
    console.log(res, err);
    setTimeout(function(){
      button.removeAttribute('disabled')
    }, 1500)
  });
}

function confirmWithdrawl(){
  var code = document.getElementById('confirmationCode').value;
  // get internalBalance before change
  firebase.database().ref('/phone/' + userObject.uid).once('value', function(snapshot){
    if(snapshot.val()){
      if(snapshot.val().code == code){
        firebase.database().ref('/queue/withdrawlAmmount/tasks').push({'userId': userObject.uid, 'ammount': totalWithdrawlAmmount, 'fee':  tokenFeeAmmount, 'ethAddress': withdrawlEthAddress}).then(function(res){
          //check internalBalance vs withdrawl ammount
        })
      }
    }
  })

}

function confirmAmmount(ammount){
  firebase.database().ref('/internalBalance/' + userObject.uid).once('value', function(snapshot){
    var data = snapshot.val()
    if(data.balance){
      // + fee
      ammountConfirmed = Number(data.balance);
      return
    }
  })
}

function Onload(){
  document.getElementById('editEth').style.display = "none";
  // loadTags();
  setTimeout(function(){
    loadBalance();
  }, 1000)
}

function calculateFee(){
  //sets innerHTML of confirmation window
  document.getElementById('ethAddressForWithdrawl').innerHTML = withdrawlEthAddress;
  document.getElementById('ammountForWithdrawl').innerHTML = numberWithCommas(withdrawlAmmount);

  console.log(withdrawlEthAddress, withdrawlAmmount);
  firebase.database().ref('/fee').once('value', function(snapshot){
    var data = snapshot.val();
    var fee = data.ethPrice / 1000

    tokenFeeAmmount = Math.ceil(fee / data.tokenPrice);
    console.log(fee, tokenFeeAmmount);
    document.getElementById('fee').innerHTML = tokenFeeAmmount;
    totalWithdrawlAmmount = numberWithCommas(withdrawlAmmount - tokenFeeAmmount);
    document.getElementById('totalWithdrawlAmmount').innerHTML = totalWithdrawlAmmount;
  })
}

function editEthAddress(){
  if(document.getElementById('editEth').style.display == "none"){
    document.getElementById('edit').innerHTML = "close";

    document.getElementById('editEth').style.display = "block";
    // document.getElementById
  }else{
    document.getElementById('editEth').style.display = "none";
    document.getElementById('edit').innerHTML = "edit";

  }
}

function submitEthAddress(){
  console.log('submitting address')
  var ethAddress = document.getElementById('myEthAddress');
  // var testAccount = '0x541E8E0b0F25f799F941932dDcB93bB83d254E64'
  // testAccount = testAccount.split('');
  console.log(ethAddress.value.length)
  if(ethAddress.value.length > 41 && ethAddress.value.length < 43){
    // console.log(ethAddress.value)
    // document.getElementById('main-container').style.display = 'none';
    loaderShow();
    // document.getElementById('loaderSection').style.display = "inital";
    // document.getElementById('loader').style.display = "inital";

    firebase.database().ref('queue/myEthAddress/tasks').push({"ethAddress": ethAddress.value, "userId": userObject.uid}).then(function(err, res){
      console.log(res, err)
      setTimeout(function(){
        loaderHide();
        document.getElementById('editEth').style.display = "none";
        document.getElementById('edit').innerHTML = "edit";
        var myAddres = document.getElementById('myAddress');
        firebase.database().ref('user/' + userObject.uid ).once('value', function(snapshot){
          var data = snapshot.val();
          if(data){
            if(data.ethAddress){
              myAddres.innerHTML = data.ethAddress;
            }else{
              return;
            }
          }else{
            return;
          }
        })
      }, 1000)
      loadBalance();
    });
  }
}

function loadBalance(){
  var userRef = firebase.database().ref('user/' + userObject.uid);
  var interalBalanceRef = firebase.database().ref('internalBalance/' + userObject.uid);
  var data;
  interalBalanceRef.once('value', function(snapshot){
    var internalBalance = snapshot.val().balance;
    if(internalBalance){
      var inter = numberWithCommas(internalBalance);
      document.getElementById('internalBalance').innerHTML = inter;
      document.getElementById('modalBalance').innerHTML = inter;


    }
  })
  userRef.on('value', function(snapshot){
    data = snapshot.val();
    if(data.ethAddress){
      document.getElementById('myAddress').innerHTML = data.ethAddress;
      document.getElementById('ethWithdrawlAddress').value = data.ethAddress;


      firebase.database().ref('queue/myEthBalance/tasks').push({"ethAddress": data.ethAddress, "userId": userObject.uid}).then(function(res){
        setTimeout(function(){
          firebase.database().ref('balance/' + userObject.uid).once('value', function(snapshot){
            if(snapshot.val()){
              var balance = snapshot.val().balance;
              console.log(balance)

              if(balance){
                var balance = numberWithCommas(balance);
                document.getElementById('balance').innerHTML = balance;
                // document.getElementById('p-completion-number').innerHTML = balance;

                document.getElementById('ethHolder').className = 'animated fadeIn';

              }
            }
          })
        }, 1000)

      });


    }
  })

}

function numberWithCommas(x) {
    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}
</script>

</html>
